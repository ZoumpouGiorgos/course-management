<%# app/views/shared/_avatar.html.erb %>
<%
  user ||= @post&.user
  return if user.nil?

  initial = user.username.to_s.first.to_s.upcase
  color   = color_from_string(user.username, saturation: 45, lightness: 55)
  link    = local_assigns.fetch(:link, true)

  avatar = content_tag(
    :div,
    initial,
    class: "inline-flex items-center justify-center w-10 h-10 rounded-full text-white font-semibold select-none shrink-0 transition-all duration-200 hover:shadow-[0_0_0_2px_var(--glow)] cursor-pointer",
    style: "background-color: #{color}; --glow: #{color};",
    title: user.username
  )
%>

<%= link ? link_to(user_path(user), class: "inline-block") { avatar } : avatar %>
